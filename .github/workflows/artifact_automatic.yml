name: Github Workflow Example
on: [push, workflow_dispatch]
jobs:
  Test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Cache Dependencies
        uses: actions/cache@v3
        with:
          path: ~/.npm
          key: npm-cache-key-${{ hashFiles('**/package-lock.json') }}
      - name: Install Dependencies
        run: npm ci
      - name: NPM Install
        run: npm install
      - name: NPM Lint
        run: npm run lint
      - name: NPM test
        run: npm run test

  Build:
    runs-on: ubuntu-latest
    needs: Test
    outputs:
      script-file: ${{ steps.publish.outputs.custom-file }}
    steps:
      - uses: actions/checkout@v4
      - name: Cache Dependencies
        uses: actions/cache@v3
        with:
          path: ~/.npm
          key: npm-cache-key-${{ hashFiles('**/package-lock.json') }}
      - name: NPM CI
        run: npm ci
      - name: NPM Install
        run: npm install
      - name: NPM Build
        run: npm run build
      - name: Publish JS filename
        id: publish
        run: find dist/assets/*.js -type f -execdir echo 'custom-file={}' >> $GITHUB_OUTPUT ';'
      - name: Generate Artifcats
        uses: actions/upload-artifact@v3
        with:
            name: dist-files
            path: dist

  info:
    needs: Build
    runs-on: ubuntu-latest
    steps:
    - name: Get Builds
      uses: actions/download-artifact@v3
      with:
        name: dist-files
    - name: Output Folder
      run: ls -la
    - name: Print Output Filename
      run: echo "${{ needs.Build.outputs.script-file }}"
    - name: Deploy
      run: echo "Deploying..."